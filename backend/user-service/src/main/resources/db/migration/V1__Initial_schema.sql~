-- ============================================================================
-- Youth Connect Uganda - User Service Initial Database Schema
-- ============================================================================
-- Version: V1
-- Description: Complete initial schema with all tables, indexes, and sample data
-- Combines best practices from both schema designs
-- ============================================================================

-- Ensure we're using the correct database
CREATE DATABASE IF NOT EXISTS youth_connect_db
CHARACTER SET utf8mb4
COLLATE utf8mb4_unicode_ci;

USE youth_connect_db;

-- Temporarily disable foreign key checks for clean setup
SET FOREIGN_KEY_CHECKS = 0;

-- ============================================================================
-- USERS TABLE - Core authentication for all platforms (Web + USSD)
-- ============================================================================
CREATE TABLE IF NOT EXISTS users (
    user_id BIGINT AUTO_INCREMENT PRIMARY KEY,

    -- Authentication Credentials
    email VARCHAR(100) NOT NULL UNIQUE COMMENT 'Primary identifier for web login',
    phone_number VARCHAR(20) UNIQUE COMMENT 'Primary identifier for USSD login',
    password_hash VARCHAR(255) NOT NULL COMMENT 'BCrypt hashed password',

    -- User Role
    role ENUM('YOUTH', 'NGO', 'FUNDER', 'SERVICE_PROVIDER', 'MENTOR', 'ADMIN') NOT NULL,

    -- Account Status & Verification
    is_active BOOLEAN DEFAULT TRUE COMMENT 'Account active status',
    is_verified BOOLEAN DEFAULT FALSE COMMENT 'Overall verification status',
    email_verified BOOLEAN DEFAULT FALSE COMMENT 'Email verification status',
    phone_verified BOOLEAN DEFAULT FALSE COMMENT 'Phone verification status',

    -- Security Tokens
    verification_token VARCHAR(255) COMMENT 'Email/phone verification token',
    reset_token VARCHAR(255) COMMENT 'Password reset token',
    reset_token_expiry DATETIME COMMENT 'Reset token expiration time',

    -- Security Audit
    last_login TIMESTAMP NULL COMMENT 'Last successful login timestamp',
    failed_login_attempts INT DEFAULT 0 COMMENT 'Failed login counter',
    account_locked_until TIMESTAMP NULL COMMENT 'Account lock expiry time',

    -- Audit Fields
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    created_by VARCHAR(100) COMMENT 'Who created this record',
    updated_by VARCHAR(100) COMMENT 'Who last updated this record',

    -- Performance Indexes
    INDEX idx_users_email (email),
    INDEX idx_users_phone (phone_number),
    INDEX idx_users_phone_active (phone_number, is_active),
    INDEX idx_users_email_active (email, is_active),
    INDEX idx_users_role (role, is_active),
    INDEX idx_users_created_at (created_at),
    INDEX idx_users_role_active_created (role, is_active, created_at),

    -- Uganda phone number validation
    CONSTRAINT chk_phone_format CHECK (
        phone_number IS NULL OR
        phone_number REGEXP '^\\+?256[0-9]{9}$|^0[0-9]{9}$'
    )
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Central user authentication for web and USSD platforms';

-- ============================================================================
-- YOUTH PROFILES TABLE - Detailed profiles for youth users
-- ============================================================================
CREATE TABLE IF NOT EXISTS youth_profiles (
    profile_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL UNIQUE,

    -- Personal Information
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    gender ENUM('MALE', 'FEMALE', 'OTHER'),
    date_of_birth DATE,

    -- Location & Demographics
    district VARCHAR(50) COMMENT 'Ugandan districts: Kampala, Wakiso, etc.',
    location VARCHAR(100) COMMENT 'Specific location within district',
    age_group VARCHAR(20) COMMENT '16-20, 21-25, 26-30, 31-35',

    -- Professional Information
    profession VARCHAR(100),
    education_level VARCHAR(50),
    business_stage ENUM('IDEA_PHASE', 'EARLY_STAGE', 'GROWTH_STAGE', 'MATURE') DEFAULT 'IDEA_PHASE',

    -- Profile Content
    bio TEXT COMMENT 'Personal biography',
    description TEXT COMMENT 'Detailed profile description',

    -- Skills and Interests (comma-separated for flexibility)
    skills TEXT COMMENT 'Comma-separated skills list',
    interests TEXT COMMENT 'Comma-separated interests list',
    looking_for VARCHAR(255) COMMENT 'What the youth is looking for',

    -- Media
    profile_picture_url VARCHAR(255),

    -- Accessibility
    has_disability BOOLEAN DEFAULT FALSE,
    disability_details TEXT,

    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    -- Foreign Key
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,

    -- Performance Indexes
    INDEX idx_youth_user_id (user_id),
    INDEX idx_youth_district (district),
    INDEX idx_youth_location (location),
    INDEX idx_youth_business_stage (business_stage),
    INDEX idx_youth_age_group (age_group),
    INDEX idx_youth_created_at (created_at),
    INDEX idx_youth_district_stage (district, business_stage, created_at),

    -- Full-text search index
    FULLTEXT INDEX idx_youth_search (first_name, last_name, profession, skills, interests)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Youth user profiles for opportunity matching and mentorship';

-- ============================================================================
-- MENTOR PROFILES TABLE - Profiles for mentor users
-- ============================================================================
CREATE TABLE IF NOT EXISTS mentor_profiles (
    mentor_profile_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL UNIQUE,

    -- Personal Information
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,

    -- Professional Information
    bio TEXT,
    area_of_expertise TEXT NOT NULL COMMENT 'Comma-separated expertise areas',
    expertise_areas TEXT COMMENT 'Alternative field name for compatibility',
    years_of_experience INT COMMENT 'Years of professional experience',
    experience_years INT COMMENT 'Alternative field name',
    organization VARCHAR(100),
    position VARCHAR(100),

    -- Availability & Capacity
    availability VARCHAR(50),
    availability_status ENUM('AVAILABLE', 'BUSY', 'ON_LEAVE') DEFAULT 'AVAILABLE',
    max_mentees INT DEFAULT 5,
    mentoring_capacity INT DEFAULT 5,

    -- Verification
    is_verified BOOLEAN DEFAULT FALSE,
    verification_notes TEXT,

    -- Media & Contact
    profile_picture_url VARCHAR(255),
    linkedin_url VARCHAR(255),
    website_url VARCHAR(255),

    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    -- Foreign Key
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,

    -- Performance Indexes
    INDEX idx_mentor_user_id (user_id),
    INDEX idx_mentor_organization (organization),
    INDEX idx_mentor_expertise (area_of_expertise(100)),
    INDEX idx_mentor_availability (availability_status),
    INDEX idx_mentor_verified (is_verified),
    INDEX idx_mentor_expertise_verified (area_of_expertise(100), is_verified, availability_status),

    -- Full-text search index
    FULLTEXT INDEX idx_mentor_search (first_name, last_name, area_of_expertise, bio)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Mentor profiles with expertise and availability tracking';

-- ============================================================================
-- NGO PROFILES TABLE - Profiles for NGO organizations
-- ============================================================================
CREATE TABLE IF NOT EXISTS ngo_profiles (
    ngo_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL UNIQUE,

    -- Organization Information
    organisation_name VARCHAR(150) NOT NULL,
    organization_name VARCHAR(150) COMMENT 'Alternative field name for compatibility',
    registration_number VARCHAR(50),
    location VARCHAR(100),
    address VARCHAR(255),
    district VARCHAR(50),
    description TEXT,

    -- Focus Areas & Target
    focus_areas TEXT COMMENT 'Comma-separated focus areas',
    target_audience VARCHAR(100),

    -- Verification
    is_verified BOOLEAN DEFAULT FALSE,
    verification_date TIMESTAMP NULL,
    verified_by BIGINT NULL,

    -- Contact Information
    contact_person VARCHAR(100),
    contact_email VARCHAR(100),
    contact_phone VARCHAR(20),

    -- Media
    logo_url VARCHAR(255),
    website_url VARCHAR(255),

    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    -- Foreign Keys
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,

    -- Performance Indexes
    INDEX idx_ngo_user_id (user_id),
    INDEX idx_ngo_name (organisation_name),
    INDEX idx_ngo_verified (is_verified),
    INDEX idx_ngo_location (location),
    INDEX idx_ngo_district (district),

    -- Full-text search index
    FULLTEXT INDEX idx_ngo_search (organisation_name, description, focus_areas)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='NGO profiles with verification and contact details';

-- ============================================================================
-- FUNDER PROFILES TABLE - Profiles for funding organizations
-- ============================================================================
CREATE TABLE IF NOT EXISTS funder_profiles (
    funder_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL UNIQUE,

    -- Organization Information
    funder_name VARCHAR(150) NOT NULL,
    organization_name VARCHAR(150) COMMENT 'Alternative field name',
    funder_type ENUM('GOVERNMENT', 'PRIVATE', 'INTERNATIONAL', 'INDIVIDUAL') DEFAULT 'PRIVATE',
    funding_type VARCHAR(50),
    description TEXT,

    -- Funding Information
    funding_focus TEXT COMMENT 'Areas of funding interest',
    focus_areas TEXT COMMENT 'Alternative field name',
    min_funding_amount DECIMAL(15,2),
    max_funding_amount DECIMAL(15,2),
    funding_currency VARCHAR(3) DEFAULT 'UGX',

    -- Contact Information
    contact_person VARCHAR(100),
    contact_email VARCHAR(100),
    website_url VARCHAR(255),
    logo_url VARCHAR(255),

    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    -- Foreign Key
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,

    -- Performance Indexes
    INDEX idx_funder_user_id (user_id),
    INDEX idx_funder_name (funder_name),
    INDEX idx_funder_type (funder_type),
    INDEX idx_funder_focus (funding_focus(100))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Funding organization profiles with financial information';

-- ============================================================================
-- SERVICE PROVIDER PROFILES TABLE - Profiles for service providers
-- ============================================================================
CREATE TABLE IF NOT EXISTS service_provider_profiles (
    provider_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL UNIQUE,

    -- Business Information
    provider_name VARCHAR(150) NOT NULL,
    organization_name VARCHAR(150) COMMENT 'Alternative field name',
    business_type VARCHAR(100),
    service_category VARCHAR(50),
    location VARCHAR(100),
    address VARCHAR(255),
    district VARCHAR(50),
    area_of_expertise TEXT NOT NULL,

    -- Services
    services_offered TEXT COMMENT 'Comma-separated services list',
    service_areas TEXT COMMENT 'Geographic areas served',
    description TEXT,

    -- Verification
    is_verified BOOLEAN DEFAULT FALSE,
    verification_date TIMESTAMP NULL,
    verified_by BIGINT NULL,

    -- Business Details
    years_in_operation INT,
    team_size VARCHAR(50),

    -- Contact Information
    contact_person VARCHAR(100),
    contact_email VARCHAR(100),
    website_url VARCHAR(255),
    logo_url VARCHAR(255),

    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    -- Foreign Key
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,

    -- Performance Indexes
    INDEX idx_provider_user_id (user_id),
    INDEX idx_provider_name (provider_name),
    INDEX idx_provider_verified (is_verified),
    INDEX idx_provider_expertise (area_of_expertise(100)),
    INDEX idx_provider_location (location),
    INDEX idx_provider_district (district)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Service provider profiles with capabilities and services';

-- ============================================================================
-- USER INTERESTS TABLE - Granular interest tracking for personalization
-- ============================================================================
CREATE TABLE IF NOT EXISTS user_interests (
    user_interest_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,

    -- Interest Details
    interest_tag VARCHAR(50) NOT NULL COMMENT 'Normalized interest tag',
    interest_name VARCHAR(50) COMMENT 'Alternative field name for compatibility',
    interest_level ENUM('LOW', 'MEDIUM', 'HIGH') DEFAULT 'MEDIUM',
    interest_category VARCHAR(50) COMMENT 'Category grouping (SECTOR, SKILL, TOPIC)',

    -- Tracking Source
    source ENUM('USER_SELECTED', 'AI_INFERRED', 'ACTIVITY_BASED', 'SURVEY', 'IMPORTED')
        DEFAULT 'USER_SELECTED',
    confidence_score DECIMAL(3,2) DEFAULT 1.00 COMMENT 'Confidence level (0.00-1.00)',

    -- Engagement Metrics
    interaction_count INT DEFAULT 0,
    last_interaction TIMESTAMP NULL,

    -- Status Management
    is_active BOOLEAN DEFAULT TRUE,
    is_primary BOOLEAN DEFAULT FALSE COMMENT 'Primary interests for priority matching',

    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    -- Foreign Key
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,

    -- Constraints
    UNIQUE KEY unique_user_interest (user_id, interest_tag),

    -- Performance Indexes
    INDEX idx_user_interests_user (user_id, is_active),
    INDEX idx_user_interests_level (user_id, interest_level, is_active),
    INDEX idx_user_interests_tag (interest_tag, is_active),
    INDEX idx_user_interests_category (interest_category, is_active),
    INDEX idx_user_interests_source (source, confidence_score),
    INDEX idx_user_interests_primary (is_primary, is_active),
    INDEX idx_user_interests_updated (updated_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='User interest tracking for personalization and recommendations';

-- ============================================================================
-- USER ACTIVITY LOGS TABLE - Comprehensive activity tracking
-- ============================================================================
CREATE TABLE IF NOT EXISTS user_activity_logs (
    log_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,

    -- Activity Classification
    activity_type VARCHAR(50) NOT NULL COMMENT 'VIEW, CLICK, APPLY, SEARCH, etc.',
    activity_category VARCHAR(50) COMMENT 'OPPORTUNITY, MENTORSHIP, PROFILE, etc.',
    activity_description TEXT COMMENT 'Detailed description',

    -- Target Entity Information
    target_id BIGINT COMMENT 'ID of interacted entity',
    target_type VARCHAR(50) COMMENT 'Type: OPPORTUNITY, MENTOR, NGO, etc.',
    target_name VARCHAR(255) COMMENT 'Human-readable target name',

    -- Action Details
    action_result ENUM('SUCCESS', 'FAILED', 'PARTIAL', 'CANCELLED') DEFAULT 'SUCCESS',
    duration_seconds INT COMMENT 'Time spent on activity',

    -- Session & Device Context
    session_id VARCHAR(255) COMMENT 'Session identifier',
    device_type ENUM('WEB', 'MOBILE', 'USSD', 'API') DEFAULT 'WEB',
    user_agent TEXT,
    ip_address VARCHAR(45) COMMENT 'IPv4 or IPv6',

    -- Location Context
    location_country VARCHAR(2) COMMENT 'ISO country code',
    location_city VARCHAR(100),

    -- Extended Metadata
    metadata JSON COMMENT 'Flexible JSON for activity-specific data',
    tags TEXT COMMENT 'Comma-separated tags for filtering',

    -- Referrer & Marketing Tracking
    referrer_url VARCHAR(500),
    utm_source VARCHAR(100),
    utm_medium VARCHAR(100),
    utm_campaign VARCHAR(100),

    -- Temporal Data
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    activity_date DATE AS (DATE(created_at)) STORED COMMENT 'For partitioning',

    -- Foreign Key
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,

    -- High-Performance Indexes
    INDEX idx_activity_user_date (user_id, activity_date, created_at),
    INDEX idx_activity_user_type_time (user_id, activity_type, created_at),
    INDEX idx_activity_target (target_type, target_id, created_at),
    INDEX idx_activity_session (session_id, created_at),
    INDEX idx_activity_type_result (activity_type, action_result, created_at),
    INDEX idx_activity_category_date (activity_category, activity_date),
    INDEX idx_activity_device (device_type, created_at),
    INDEX idx_activity_campaign (utm_campaign, created_at),
    INDEX idx_activity_type (activity_type),
    INDEX idx_activity_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Comprehensive user activity tracking for analytics';

-- ============================================================================
-- USER SESSIONS TABLE - Session tracking for audit and analytics
-- ============================================================================
CREATE TABLE IF NOT EXISTS user_sessions (
    session_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    session_token VARCHAR(500) NOT NULL,
    device_type ENUM('WEB', 'MOBILE', 'USSD') DEFAULT 'WEB',
    ip_address VARCHAR(45),
    user_agent TEXT,

    -- Session Management
    login_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_activity TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    logout_time TIMESTAMP NULL,
    expires_at TIMESTAMP NOT NULL,

    -- Foreign Key
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,

    -- Indexes
    INDEX idx_sessions_user (user_id),
    INDEX idx_sessions_token (session_token),
    INDEX idx_sessions_expires (expires_at),
    INDEX idx_sessions_device (device_type)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='User session tracking for security and analytics';

-- ============================================================================
-- AUDIT TRAIL TABLE - Security and compliance logging
-- ============================================================================
CREATE TABLE IF NOT EXISTS audit_trail (
    audit_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NULL,

    -- Audit Information
    action_type VARCHAR(100) NOT NULL COMMENT 'LOGIN, REGISTER, UPDATE_PROFILE, etc.',
    entity_type VARCHAR(100),
    entity_id BIGINT,
    description TEXT,

    -- Request Details
    ip_address VARCHAR(45),
    user_agent TEXT,
    request_url VARCHAR(500),

    -- Status
    status ENUM('SUCCESS', 'FAILED', 'PARTIAL') NOT NULL,
    error_message TEXT,

    -- Timestamp
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    -- Foreign Key
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE SET NULL,

    -- Indexes
    INDEX idx_audit_user (user_id),
    INDEX idx_audit_action (action_type),
    INDEX idx_audit_entity (entity_type, entity_id),
    INDEX idx_audit_created (created_at),
    INDEX idx_audit_user_created (user_id, created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Audit trail for security and compliance';

-- Re-enable foreign key checks
SET FOREIGN_KEY_CHECKS = 1;

-- ============================================================================
-- INITIAL DATA - Sample users and data for testing
-- ============================================================================

-- Default Admin User (Password: Admin@123)
INSERT INTO users (email, phone_number, password_hash, role, is_active, email_verified, phone_verified)
VALUES (
    'admin@youthconnect.ug',
    '+256700000000',
    '$2a$12$rQOZgIwI6k8QpqZtDlEPUeF5HYD8v4x1z0fXhRtF8gHy7uPjI9QeK',
    'ADMIN',
    TRUE,
    TRUE,
    TRUE
) ON DUPLICATE KEY UPDATE email = email;

-- Sample Youth User (Password: Youth@123)
INSERT INTO users (email, phone_number, password_hash, role, is_active, email_verified)
VALUES (
    'sample.youth@youthconnect.ug',
    '+256701234567',
    '$2a$12$rQOZgIwI6k8QpqZtDlEPUeF5HYD8v4x1z0fXhRtF8gHy7uPjI9QeK',
    'YOUTH',
    TRUE,
    TRUE
) ON DUPLICATE KEY UPDATE email = email;

-- Youth Profile for sample user
INSERT INTO youth_profiles (user_id, first_name, last_name, gender, district, profession, business_stage, skills)
SELECT user_id, 'John', 'Doe', 'MALE', 'Kampala', 'Software Developer', 'EARLY_STAGE',
       'Java,Spring Boot,MySQL,React'
FROM users WHERE email = 'sample.youth@youthconnect.ug'
ON DUPLICATE KEY UPDATE first_name = first_name;

-- Sample Mentor User (Password: Mentor@123)
INSERT INTO users (email, phone_number, password_hash, role, is_active, email_verified)
VALUES (
    'sample.mentor@youthconnect.ug',
    '+256702345678',
    '$2a$12$rQOZgIwI6k8QpqZtDlEPUeF5HYD8v4x1z0fXhRtF8gHy7uPjI9QeK',
    'MENTOR',
    TRUE,
    TRUE
) ON DUPLICATE KEY UPDATE email = email;

-- Mentor Profile
INSERT INTO mentor_profiles (user_id, first_name, last_name, bio, area_of_expertise, experience_years, is_verified)
SELECT user_id, 'Jane', 'Smith',
       'Experienced business consultant with 10+ years in entrepreneurship',
       'Business Strategy,Financial Planning,Startup Development',
       10, TRUE
FROM users WHERE email = 'sample.mentor@youthconnect.ug'
ON DUPLICATE KEY UPDATE first_name = first_name;

-- Sample Interests
INSERT INTO user_interests (user_id, interest_tag, interest_level, source, interest_category, is_primary)
SELECT user_id, 'technology', 'HIGH', 'USER_SELECTED', 'SECTOR', TRUE
FROM users WHERE email = 'sample.youth@youthconnect.ug'
ON DUPLICATE KEY UPDATE interest_level = 'HIGH';

INSERT INTO user_interests (user_id, interest_tag, interest_level, source, interest_category, is_primary)
SELECT user_id, 'software-development', 'HIGH', 'USER_SELECTED', 'SKILL', TRUE
FROM users WHERE email = 'sample.youth@youthconnect.ug'
ON DUPLICATE KEY UPDATE interest_level = 'HIGH';

INSERT INTO user_interests (user_id, interest_tag, interest_level, source, interest_category, is_primary)
SELECT user_id, 'entrepreneurship', 'MEDIUM', 'ACTIVITY_BASED', 'TOPIC', FALSE
FROM users WHERE email = 'sample.youth@youthconnect.ug'
ON DUPLICATE KEY UPDATE interest_level = 'MEDIUM';

-- ============================================================================
-- VERIFICATION QUERIES
-- ============================================================================

-- Display all tables created
SELECT
    TABLE_NAME,
    TABLE_ROWS,
    ROUND((DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024, 2) AS 'SIZE_MB',
    TABLE_COMMENT
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA = DATABASE()
AND TABLE_TYPE = 'BASE TABLE'
ORDER BY TABLE_NAME;

-- Display foreign keys
SELECT
    TABLE_NAME,
    CONSTRAINT_NAME,
    REFERENCED_TABLE_NAME,
    REFERENCED_COLUMN_NAME
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
WHERE TABLE_SCHEMA = DATABASE()
AND REFERENCED_TABLE_NAME IS NOT NULL
ORDER BY TABLE_NAME;

-- Display indexes
SELECT
    TABLE_NAME,
    INDEX_NAME,
    COLUMN_NAME,
    INDEX_TYPE,
    NON_UNIQUE
FROM INFORMATION_SCHEMA.STATISTICS
WHERE TABLE_SCHEMA = DATABASE()
AND INDEX_NAME != 'PRIMARY'
ORDER BY TABLE_NAME, INDEX_NAME;

-- Success message
SELECT '✓ Youth Connect Uganda database schema created successfully!' AS Result;
SELECT CONCAT('✓ ', COUNT(*), ' tables created') AS Summary
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA = DATABASE() AND TABLE_TYPE = 'BASE TABLE';