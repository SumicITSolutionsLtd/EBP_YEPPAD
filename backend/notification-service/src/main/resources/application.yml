spring:
  cloud:
    gateway:
      routes:
        # ============================================================
        # NOTIFICATION SERVICE ROUTES (Internal - No Auth Required)
        # ============================================================
        
        # Public Health Check
        - id: notification-service-health
          uri: lb://notification-service
          predicates:
            - Path=/api/notifications/health
            - Method=GET
          filters:
            - name: CircuitBreaker
              args:
                name: notificationServiceCircuitBreaker
                fallbackUri: forward:/fallback/notifications

        # Internal Notification Endpoints (Called by other services)
        - id: notification-service-internal
          uri: lb://notification-service
          predicates:
            - Path=/api/notifications/**
            - Method=POST
          filters:
            - name: CircuitBreaker
              args:
                name: notificationServiceCircuitBreaker
                fallbackUri: forward:/fallback/notifications
          # ⚠️ No authentication - internal service only

        # Notification Statistics (Admin/Monitoring)
        - id: notification-service-stats
          uri: lb://notification-service
          predicates:
            - Path=/api/notifications/stats, /api/notifications/user/*/history, /api/notifications/failed
            - Method=GET
          filters:
            - name: CircuitBreaker
              args:
                name: notificationServiceCircuitBreaker
          # ✅ Authentication required (headers added by gateway if JWT present)